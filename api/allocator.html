

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Allocator Module &mdash; RedisAllocator 0.0.1</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script type="module" src="https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs"></script>
      <script type="module" src="https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs"></script>
      <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";import elkLayouts from "https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs";mermaid.registerLayoutLoaders(elkLayouts);mermaid.initialize({startOnLoad:false});</script>
      <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
      <script type="module">
import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";
window.addEventListener("load", () => mermaid.run());
</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Task Queue Module" href="task_queue.html" />
    <link rel="prev" title="Lock Module" href="lock.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            RedisAllocator
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/proxy_pool.html">Example: Managing a Proxy Pool with Automatic Updates</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="lock.html">Lock Module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Allocator Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#redisallocator">RedisAllocator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocator"><code class="docutils literal notranslate"><span class="pre">RedisAllocator</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#redisallocatorobject">RedisAllocatorObject</a></li>
<li class="toctree-l3"><a class="reference internal" href="#redisallocatableclass">RedisAllocatableClass</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatableClass"><code class="docutils literal notranslate"><span class="pre">RedisAllocatableClass</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#redisthreadhealthcheckpool">RedisThreadHealthCheckPool</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisThreadHealthCheckPool"><code class="docutils literal notranslate"><span class="pre">RedisThreadHealthCheckPool</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-0">Allocator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">RedisThreadHealthCheckPool</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">RedisThreadHealthCheckPool.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">RedisThreadHealthCheckPool.current_thread_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">RedisThreadHealthCheckPool.initialize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">RedisThreadHealthCheckPool.update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">RedisThreadHealthCheckPool.finalize()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id6"><code class="docutils literal notranslate"><span class="pre">RedisAllocatableClass</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id7"><code class="docutils literal notranslate"><span class="pre">RedisAllocatableClass.set_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8"><code class="docutils literal notranslate"><span class="pre">RedisAllocatableClass.open()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9"><code class="docutils literal notranslate"><span class="pre">RedisAllocatableClass.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10"><code class="docutils literal notranslate"><span class="pre">RedisAllocatableClass.is_healthy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11"><code class="docutils literal notranslate"><span class="pre">RedisAllocatableClass.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12"><code class="docutils literal notranslate"><span class="pre">RedisAllocatableClass.unique_id</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorObject</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject.__init__"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorObject.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject.allocator"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorObject.allocator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject.key"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorObject.key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject.obj"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorObject.obj</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject.params"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorObject.params</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject.update"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorObject.update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject.open"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorObject.open()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject.close"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorObject.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject.is_healthy"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorObject.is_healthy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject.set_healthy"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorObject.set_healthy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject.set_unhealthy"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorObject.set_unhealthy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject.refresh"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorObject.refresh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject.refresh_until_healthy"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorObject.refresh_until_healthy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject.unique_id"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorObject.unique_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject.name"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorObject.name</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorUpdater"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorUpdater</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorUpdater.__init__"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorUpdater.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorUpdater.fetch"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorUpdater.fetch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorUpdater.__call__"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorUpdater.__call__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorUpdater.__len__"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorUpdater.__len__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorPolicy"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorPolicy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorPolicy.initialize"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorPolicy.initialize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorPolicy.malloc"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorPolicy.malloc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorPolicy.refresh_pool"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorPolicy.refresh_pool()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorPolicy.refresh_pool_all"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorPolicy.refresh_pool_all()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorPolicy.check_health_once"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorPolicy.check_health_once()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorPolicy.check_health"><code class="docutils literal notranslate"><span class="pre">RedisAllocatorPolicy.check_health()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#redis_allocator.allocator.DefaultRedisAllocatorPolicy"><code class="docutils literal notranslate"><span class="pre">DefaultRedisAllocatorPolicy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.DefaultRedisAllocatorPolicy.__init__"><code class="docutils literal notranslate"><span class="pre">DefaultRedisAllocatorPolicy.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.DefaultRedisAllocatorPolicy.initialize"><code class="docutils literal notranslate"><span class="pre">DefaultRedisAllocatorPolicy.initialize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.DefaultRedisAllocatorPolicy.refresh_pool_all"><code class="docutils literal notranslate"><span class="pre">DefaultRedisAllocatorPolicy.refresh_pool_all()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.DefaultRedisAllocatorPolicy.malloc"><code class="docutils literal notranslate"><span class="pre">DefaultRedisAllocatorPolicy.malloc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.DefaultRedisAllocatorPolicy.refresh_pool"><code class="docutils literal notranslate"><span class="pre">DefaultRedisAllocatorPolicy.refresh_pool()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#redis_allocator.allocator.DefaultRedisAllocatorPolicy.finalize"><code class="docutils literal notranslate"><span class="pre">DefaultRedisAllocatorPolicy.finalize()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id13"><code class="docutils literal notranslate"><span class="pre">RedisAllocator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id14"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id15"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.object_key()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id16"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.clear()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id17"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.extend()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id18"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.shrink()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id19"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.assign()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id20"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id21"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.__contains__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id22"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.update_soft_bind()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id23"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.unbind_soft_bind()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id24"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.get_soft_bind()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id25"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.malloc_key()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id26"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.malloc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id27"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.free_keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id28"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.free()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id29"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.get_free_list()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id30"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.redis</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id31"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.prefix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id32"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.suffix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id33"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.eps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id34"><code class="docutils literal notranslate"><span class="pre">RedisAllocator.gc()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#core-concepts-visualization">Core Concepts &amp; Visualization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#allocator-pool-structure-conceptual">Allocator Pool Structure (Conceptual)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#simplified-allocation-flow-non-shared-mode">Simplified Allocation Flow (Non-Shared Mode)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#simplified-free-flow-non-shared-mode">Simplified Free Flow (Non-Shared Mode)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#shared-mode">Shared Mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="task_queue.html">Task Queue Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="task_queue.html#module-0">Task Queue</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../git_history.html">Git Commit History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">RedisAllocator</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">API Reference</a></li>
      <li class="breadcrumb-item active">Allocator Module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/allocator.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="allocator-module">
<h1>Allocator Module<a class="headerlink" href="#allocator-module" title="Link to this heading"></a></h1>
<p id="module-redis_allocator.allocator">This module provides resource allocation mechanisms using Redis as the backend.</p>
<section id="redisallocator">
<h2>RedisAllocator<a class="headerlink" href="#redisallocator" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">redis_allocator.allocator.</span></span><span class="sig-name descname"><span class="pre">RedisAllocator</span></span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator" title="Link to this definition"></a></dt>
<dd><p>A Redis-based distributed allocation system.</p>
<p>Manages a pool of resource identifiers (keys) using Redis, allowing distributed
clients to allocate, free, and manage these resources. It leverages Redis’s
atomic operations via Lua scripts for safe concurrent access.</p>
<p>The allocator maintains a doubly-linked list in a Redis hash to track available
(free) resources. Allocated resources are tracked using standard Redis keys
that act as locks.</p>
<p>Key Concepts:
- Allocation Pool: A set of resource identifiers (keys) managed by the allocator.</p>
<blockquote>
<div><p>Stored in a Redis hash (<cite>&lt;prefix&gt;|&lt;suffix&gt;|pool</cite>) representing a doubly-linked list.
Head/Tail pointers are stored in separate keys (<cite>&lt;prefix&gt;|&lt;suffix&gt;|pool|head</cite>,
<cite>&lt;prefix&gt;|&lt;suffix&gt;|pool|tail</cite>).</p>
</div></blockquote>
<ul class="simple">
<li><p>Free List: The subset of keys within the pool that are currently available.
Represented by the linked list structure within the pool hash.</p></li>
<li><p>Allocated State: A key is considered allocated if a corresponding lock key exists
(<cite>&lt;prefix&gt;|&lt;suffix&gt;:&lt;key&gt;</cite>).</p></li>
<li><p>Shared Mode: If <cite>shared=True</cite>, allocating a key moves it to the tail of the
free list but does <em>not</em> create a lock key. This allows multiple clients to
“allocate” the same key concurrently, effectively using the list as a rotating pool.
If <cite>shared=False</cite> (default), allocation creates a lock key, granting exclusive access.</p></li>
<li><p>Soft Binding: Allows associating a logical name with an allocated key. If an object
provides a <cite>name</cite>, the allocator tries to reuse the previously bound key for that name.
Stored in Redis keys like <cite>&lt;prefix&gt;|&lt;suffix&gt;-cache:bind:&lt;name&gt;</cite>.</p></li>
<li><p>Garbage Collection (GC): Periodically scans the pool to reconcile the free list
with the lock states. Removes expired/locked items from the free list and returns
items whose locks have expired back to the free list.</p></li>
<li><p>Policies: Uses <cite>RedisAllocatorPolicy</cite> (e.g., <cite>DefaultRedisAllocatorPolicy</cite>)
to customize allocation behavior, GC triggering, and pool updates.</p></li>
</ul>
<p>Generic type U should implement <cite>RedisAllocatableClass</cite>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">redis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'allocator'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.__init__" title="Link to this definition"></a></dt>
<dd><p>Initializes the RedisAllocator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>redis</strong> (<a class="reference external" href="https://redis-py.readthedocs.io/en/stable/connections.html#redis.Redis" title="(in redis-py v99.99.99)"><em>Redis</em></a>) – StrictRedis client instance (must decode responses).</p></li>
<li><p><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Prefix for all Redis keys used by this allocator instance.</p></li>
<li><p><strong>suffix</strong> – Suffix to uniquely identify this allocator instance’s keys.</p></li>
<li><p><strong>eps</strong> – Small float tolerance for comparisons (used by underlying lock).</p></li>
<li><p><strong>shared</strong> – If True, operates in shared mode (keys are rotated, not locked).
If False (default), keys are locked upon allocation.</p></li>
<li><p><strong>policy</strong> (<a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorPolicy" title="redis_allocator.allocator.RedisAllocatorPolicy"><em>RedisAllocatorPolicy</em></a><em>[</em><em>U</em><em>] </em><em>| </em><em>None</em>) – Optional allocation policy. Defaults to <cite>DefaultRedisAllocatorPolicy</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.object_key">
<span class="sig-name descname"><span class="pre">object_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.object_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.object_key" title="Link to this definition"></a></dt>
<dd><p>Get the key for an object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>obj</strong> (<em>U</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.clear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.clear" title="Link to this definition"></a></dt>
<dd><p>Empty the pool.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.extend">
<span class="sig-name descname"><span class="pre">extend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.extend"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.extend" title="Link to this definition"></a></dt>
<dd><p>Add new resources to the allocation pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>] </em><em>| </em><em>None</em>) – Sequence of resource identifiers to add to the pool</p></li>
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Optional timeout in seconds for the pool items (-1 means no timeout)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.shrink">
<span class="sig-name descname"><span class="pre">shrink</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.shrink"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.shrink" title="Link to this definition"></a></dt>
<dd><p>Remove resources from the allocation pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>] </em><em>| </em><em>None</em>) – Sequence of resource identifiers to remove from the pool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.assign" title="Link to this definition"></a></dt>
<dd><p>Completely replace the resources in the allocation pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>] </em><em>| </em><em>None</em>) – Sequence of resource identifiers to assign to the pool,
replacing any existing resources</p></li>
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Optional timeout in seconds for the pool items (-1 means no timeout)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.keys" title="Link to this definition"></a></dt>
<dd><p>Get all resource identifiers in the allocation pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Iterable of resource identifiers in the pool</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.13)"><em>Iterable</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.__contains__">
<span class="sig-name descname"><span class="pre">__contains__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.__contains__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.__contains__" title="Link to this definition"></a></dt>
<dd><p>Check if a resource identifier is in the allocation pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> – Resource identifier to check</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the resource is in the pool, False otherwise</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.update_soft_bind">
<span class="sig-name descname"><span class="pre">update_soft_bind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3600</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.update_soft_bind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.update_soft_bind" title="Link to this definition"></a></dt>
<dd><p>Update a soft binding between a name and a resource.</p>
<p>Soft bindings create a persistent mapping between named objects and allocated keys,
allowing the same key to be consistently allocated to the same named object.
This is useful for maintaining affinity between objects and their resources.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name to bind</p></li>
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Resource identifier to bind to the name</p></li>
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.unbind_soft_bind">
<span class="sig-name descname"><span class="pre">unbind_soft_bind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.unbind_soft_bind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.unbind_soft_bind" title="Link to this definition"></a></dt>
<dd><p>Remove a soft binding.</p>
<p>This removes the persistent mapping between a named object and its allocated key,
allowing the key to be freely allocated to any requestor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the soft binding to remove</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.get_soft_bind">
<span class="sig-name descname"><span class="pre">get_soft_bind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.get_soft_bind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.get_soft_bind" title="Link to this definition"></a></dt>
<dd><p>Get the resource identifier bound to a name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the soft binding</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.malloc_key">
<span class="sig-name descname"><span class="pre">malloc_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3600</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.malloc_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.malloc_key" title="Link to this definition"></a></dt>
<dd><p>Allocate a resource key from the pool.</p>
<p>The behavior depends on the allocator’s shared mode:
- In non-shared mode (default): Locks the allocated key for exclusive access
- In shared mode: Simply removes the key from the free list without locking it</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>) – How long the allocation lock should be valid (in seconds).</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Optional name to use for soft binding.</p></li>
<li><p><strong>cache_timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>) – Timeout for the soft binding cache entry (seconds).
Defaults to 3600. If &lt;= 0, cache entry persists indefinitely.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Resource identifier if allocation was successful, None otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.malloc">
<span class="sig-name descname"><span class="pre">malloc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3600</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.malloc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.malloc" title="Link to this definition"></a></dt>
<dd><p>Allocate a resource from the pool and wrap it in a RedisAllocatorObject.</p>
<p>If a policy is configured, it will be used to control the allocation behavior.
Otherwise, the basic allocation mechanism will be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>) – How long the allocation lock should be valid (in seconds)</p></li>
<li><p><strong>obj</strong> (<em>U</em><em> | </em><em>None</em>) – The object to wrap in the RedisAllocatorObject. If it has a <cite>.name</cite>,
soft binding will be attempted.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> | </em><em>None</em>) – Additional parameters to associate with the allocated object.</p></li>
<li><p><strong>cache_timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>) – Timeout for the soft binding cache entry (seconds).
Defaults to 3600. Passed to the policy or <cite>malloc_key</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>RedisAllocatorObject wrapping the allocated resource if successful, None otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject" title="redis_allocator.allocator.RedisAllocatorObject"><em>RedisAllocatorObject</em></a>[<em>U</em>] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.free_keys">
<span class="sig-name descname"><span class="pre">free_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.free_keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.free_keys" title="Link to this definition"></a></dt>
<dd><p>Free allocated resources.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Resource identifiers to free</p></li>
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Optional timeout in seconds for the pool items (-1 means no timeout)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.free">
<span class="sig-name descname"><span class="pre">free</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.free"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.free" title="Link to this definition"></a></dt>
<dd><p>Free an allocated object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> (<a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject" title="redis_allocator.allocator.RedisAllocatorObject"><em>RedisAllocatorObject</em></a><em>[</em><em>U</em><em>]</em>) – The allocated object to free</p></li>
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Optional timeout in seconds for the pool item (-1 means no timeout)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.__iter__">
<span class="sig-name descname"><span class="pre">__iter__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.__iter__" title="Link to this definition"></a></dt>
<dd><p>Iterate over the keys in the pool.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.__len__" title="Link to this definition"></a></dt>
<dd><p>Get the number of keys in the pool.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.deleq">
<span class="sig-name descname"><span class="pre">deleq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.deleq" title="Link to this definition"></a></dt>
<dd><p>Deletes a key when the comparison value is equal to the current value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.delge">
<span class="sig-name descname"><span class="pre">delge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.delge" title="Link to this definition"></a></dt>
<dd><p>Deletes a key when the comparison value is greater than or equal to the current value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.delgt">
<span class="sig-name descname"><span class="pre">delgt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.delgt" title="Link to this definition"></a></dt>
<dd><p>Deletes a key when the comparison value is greater than the current value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.delle">
<span class="sig-name descname"><span class="pre">delle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.delle" title="Link to this definition"></a></dt>
<dd><p>Deletes a key when the comparison value is less than or equal to the current value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.dellt">
<span class="sig-name descname"><span class="pre">dellt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.dellt" title="Link to this definition"></a></dt>
<dd><p>Deletes a key when the comparison value is less than the current value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.delne">
<span class="sig-name descname"><span class="pre">delne</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.delne" title="Link to this definition"></a></dt>
<dd><p>Deletes a key when the comparison value is not equal to the current value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.get_free_list">
<span class="sig-name descname"><span class="pre">get_free_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.get_free_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.get_free_list" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.health_check">
<span class="sig-name descname"><span class="pre">health_check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.health_check" title="Link to this definition"></a></dt>
<dd><p>Check the health status of the keys in the pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple of (locked_count, free_count)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><em>Tuple</em></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.is_locked">
<span class="sig-name descname"><span class="pre">is_locked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.is_locked" title="Link to this definition"></a></dt>
<dd><p>Check if a key is locked.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The key to check.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the key is locked, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.items_locked_status">
<span class="sig-name descname"><span class="pre">items_locked_status</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.items_locked_status" title="Link to this definition"></a></dt>
<dd><p>Get (key, lock_status) pairs for all keys in the pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.13)"><em>Iterable</em></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><em>Tuple</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.key_status">
<span class="sig-name descname"><span class="pre">key_status</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.key_status" title="Link to this definition"></a></dt>
<dd><p>Get the status of a key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The key to check the status of.</p></li>
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The lock timeout in seconds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The current status of the key.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="lock.html#redis_allocator.lock.LockStatus" title="redis_allocator.lock.LockStatus"><em>LockStatus</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.lock">
<span class="sig-name descname"><span class="pre">lock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.lock" title="Link to this definition"></a></dt>
<dd><p>Try to lock a key for a specified duration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The key to lock.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The value to set for the key.</p></li>
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>) – The lock timeout in seconds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the ownership of the key is successfully acquired, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.lock_value">
<span class="sig-name descname"><span class="pre">lock_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.lock_value" title="Link to this definition"></a></dt>
<dd><p>Get the value of a locked key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The key to get the value of.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the key if the key is locked, None otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.rlock">
<span class="sig-name descname"><span class="pre">rlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.rlock" title="Link to this definition"></a></dt>
<dd><p>Try to lock a key for a specified duration.</p>
<p>When the value is the same as the current value, the function will return True.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The key to lock.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The value to set for the key.</p></li>
<li><p><strong>timeout</strong> – The lock timeout in seconds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the ownership of the key is successfully acquired, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.seteq">
<span class="sig-name descname"><span class="pre">seteq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.seteq" title="Link to this definition"></a></dt>
<dd><p>Sets a new value when the comparison value is equal to the current value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>)</p></li>
<li><p><strong>set_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>ex</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.setge">
<span class="sig-name descname"><span class="pre">setge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.setge" title="Link to this definition"></a></dt>
<dd><p>Sets a new value when the comparison value is greater than or equal to the current value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>)</p></li>
<li><p><strong>set_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>ex</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.setgt">
<span class="sig-name descname"><span class="pre">setgt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.setgt" title="Link to this definition"></a></dt>
<dd><p>Sets a new value when the comparison value is greater than the current value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>)</p></li>
<li><p><strong>set_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>ex</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.setle">
<span class="sig-name descname"><span class="pre">setle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.setle" title="Link to this definition"></a></dt>
<dd><p>Sets a new value when the comparison value is less than or equal to the current value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>)</p></li>
<li><p><strong>set_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>ex</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.setlt">
<span class="sig-name descname"><span class="pre">setlt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.setlt" title="Link to this definition"></a></dt>
<dd><p>Sets a new value when the comparison value is less than the current value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>)</p></li>
<li><p><strong>set_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>ex</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.setne">
<span class="sig-name descname"><span class="pre">setne</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.setne" title="Link to this definition"></a></dt>
<dd><p>Sets a new value when the comparison value is not equal to the current value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>)</p></li>
<li><p><strong>set_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>ex</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.unlock">
<span class="sig-name descname"><span class="pre">unlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.unlock" title="Link to this definition"></a></dt>
<dd><p>Forcefully release a key without checking if the key is locked.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The key to release.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the key is successfully released, False if the key is not locked.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.update" title="Link to this definition"></a></dt>
<dd><p>Lock a key for a specified duration without checking if the key is already locked.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The key to lock.</p></li>
<li><p><strong>value</strong> – The value to set for the key.</p></li>
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>) – The lock timeout in seconds.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.values_lock_status">
<span class="sig-name descname"><span class="pre">values_lock_status</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.values_lock_status" title="Link to this definition"></a></dt>
<dd><p>Get the lock status of all keys in the pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.13)"><em>Iterable</em></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.redis">
<span class="sig-name descname"><span class="pre">redis</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://redis-py.readthedocs.io/en/stable/connections.html#redis.Redis" title="(in redis-py v99.99.99)"><span class="pre">Redis</span></a></em><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.redis" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.prefix">
<span class="sig-name descname"><span class="pre">prefix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.prefix" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.suffix">
<span class="sig-name descname"><span class="pre">suffix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.suffix" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.eps">
<span class="sig-name descname"><span class="pre">eps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.eps" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocator.gc">
<span class="sig-name descname"><span class="pre">gc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.gc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocator.gc" title="Link to this definition"></a></dt>
<dd><p>Perform garbage collection on the allocation pool.</p>
<p>This method scans through the pool and ensures consistency between
the allocation metadata and the actual locks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>count</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of items to check in this garbage collection pass</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="redisallocatorobject">
<h2>RedisAllocatorObject<a class="headerlink" href="#redisallocatorobject" title="Link to this heading"></a></h2>
</section>
<section id="redisallocatableclass">
<h2>RedisAllocatableClass<a class="headerlink" href="#redisallocatableclass" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatableClass">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">redis_allocator.allocator.</span></span><span class="sig-name descname"><span class="pre">RedisAllocatableClass</span></span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatableClass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatableClass" title="Link to this definition"></a></dt>
<dd><p>A class that can be allocated through RedisAllocator.</p>
<p>You should inherit from this class and implement the set_config method.</p>
<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatableClass.set_config">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatableClass.set_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatableClass.set_config" title="Link to this definition"></a></dt>
<dd><p>Set the configuration for the object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The key to set the configuration for.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – The parameters to set the configuration for.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatableClass.open">
<span class="sig-name descname"><span class="pre">open</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatableClass.open"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatableClass.open" title="Link to this definition"></a></dt>
<dd><p>Open the object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatableClass.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatableClass.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatableClass.close" title="Link to this definition"></a></dt>
<dd><p>close the object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatableClass.is_healthy">
<span class="sig-name descname"><span class="pre">is_healthy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatableClass.is_healthy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatableClass.is_healthy" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatableClass.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatableClass.name" title="Link to this definition"></a></dt>
<dd><p>Get the cache name of the object, if is none no soft binding will be used.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatableClass.unique_id">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unique_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatableClass.unique_id" title="Link to this definition"></a></dt>
<dd><p>Get the unique ID of the object.</p>
</dd></dl>

</dd></dl>

</section>
<section id="redisthreadhealthcheckpool">
<h2>RedisThreadHealthCheckPool<a class="headerlink" href="#redisthreadhealthcheckpool" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisThreadHealthCheckPool">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">redis_allocator.allocator.</span></span><span class="sig-name descname"><span class="pre">RedisThreadHealthCheckPool</span></span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisThreadHealthCheckPool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisThreadHealthCheckPool" title="Link to this definition"></a></dt>
<dd><p>A class that provides a simple interface for managing the health status of a thread.</p>
<p>This class enables tracking the health status of threads in a distributed environment
using Redis locks.</p>
<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisThreadHealthCheckPool.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">redis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisThreadHealthCheckPool.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisThreadHealthCheckPool.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize a RedisThreadHealthCheckPool instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>redis</strong> (<a class="reference external" href="https://redis-py.readthedocs.io/en/stable/connections.html#redis.Redis" title="(in redis-py v99.99.99)"><em>Redis</em></a>) – The Redis client used for interacting with Redis.</p></li>
<li><p><strong>identity</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The identity prefix for the health checker.</p></li>
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The timeout for health checks in seconds.</p></li>
<li><p><strong>tasks</strong> – A list of thread identifiers to track.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisThreadHealthCheckPool.current_thread_id">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">current_thread_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#redis_allocator.allocator.RedisThreadHealthCheckPool.current_thread_id" title="Link to this definition"></a></dt>
<dd><p>Get the current thread ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The current thread ID as a string.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisThreadHealthCheckPool.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisThreadHealthCheckPool.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisThreadHealthCheckPool.initialize" title="Link to this definition"></a></dt>
<dd><p>Initialize the health status.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisThreadHealthCheckPool.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisThreadHealthCheckPool.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisThreadHealthCheckPool.update" title="Link to this definition"></a></dt>
<dd><p>Update the health status.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisThreadHealthCheckPool.finalize">
<span class="sig-name descname"><span class="pre">finalize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisThreadHealthCheckPool.finalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisThreadHealthCheckPool.finalize" title="Link to this definition"></a></dt>
<dd><p>Finalize the health status.</p>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="module-0">
<span id="allocator"></span><h1>Allocator<a class="headerlink" href="#module-0" title="Link to this heading"></a></h1>
<p>Redis-based distributed memory allocation system.</p>
<p>This module provides the core functionality of the RedisAllocator system,
allowing for distributed memory allocation with support for garbage collection,
thread health checking, and priority-based allocation mechanisms.</p>
<p>Key features:
1. Shared vs non-shared allocation modes:</p>
<blockquote>
<div><ul class="simple">
<li><p>In shared mode, allocating an item simply removes it from the free list and puts it back to the tail</p></li>
<li><p>In non-shared mode, allocation locks the item to prevent others from accessing it</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Garbage collection for stale/unhealthy items:
- Items that are locked (unhealthy) but in the free list are removed
- Items that are not in the free list but haven’t been updated within their timeout are freed</p></li>
<li><p>Soft binding mechanism:
- Maps object names to allocated keys for consistent allocation
- Prioritizes previously allocated keys when the same named object requests allocation</p></li>
<li><p>Support for an updater to refresh the pool’s keys periodically</p></li>
<li><p>Policy-based control of allocation behavior through RedisAllocatorPolicy</p></li>
</ol>
<dl class="py class">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">redis_allocator.allocator.</span></span><span class="sig-name descname"><span class="pre">RedisThreadHealthCheckPool</span></span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisThreadHealthCheckPool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="lock.html#redis_allocator.lock.RedisLockPool" title="redis_allocator.lock.RedisLockPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedisLockPool</span></code></a></p>
<p>A class that provides a simple interface for managing the health status of a thread.</p>
<p>This class enables tracking the health status of threads in a distributed environment
using Redis locks.</p>
<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">redis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisThreadHealthCheckPool.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Initialize a RedisThreadHealthCheckPool instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>redis</strong> (<a class="reference external" href="https://redis-py.readthedocs.io/en/stable/connections.html#redis.Redis" title="(in redis-py v99.99.99)"><em>Redis</em></a>) – The Redis client used for interacting with Redis.</p></li>
<li><p><strong>identity</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The identity prefix for the health checker.</p></li>
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The timeout for health checks in seconds.</p></li>
<li><p><strong>tasks</strong> – A list of thread identifiers to track.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">current_thread_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd><p>Get the current thread ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The current thread ID as a string.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisThreadHealthCheckPool.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd><p>Initialize the health status.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisThreadHealthCheckPool.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd><p>Update the health status.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">finalize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisThreadHealthCheckPool.finalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd><p>Finalize the health status.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="id6">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">redis_allocator.allocator.</span></span><span class="sig-name descname"><span class="pre">RedisAllocatableClass</span></span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatableClass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>A class that can be allocated through RedisAllocator.</p>
<p>You should inherit from this class and implement the set_config method.</p>
<dl class="py method">
<dt class="sig sig-object py" id="id7">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatableClass.set_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd><p>Set the configuration for the object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The key to set the configuration for.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – The parameters to set the configuration for.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">open</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatableClass.open"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd><p>Open the object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatableClass.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd><p>close the object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">is_healthy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatableClass.is_healthy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id10" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id11">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><a class="headerlink" href="#id11" title="Link to this definition"></a></dt>
<dd><p>Get the cache name of the object, if is none no soft binding will be used.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id12">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unique_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#id12" title="Link to this definition"></a></dt>
<dd><p>Get the unique ID of the object.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorObject">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">redis_allocator.allocator.</span></span><span class="sig-name descname"><span class="pre">RedisAllocatorObject</span></span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorObject"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorObject" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generic" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">U</span></code>]</p>
<p>Represents an object allocated through RedisAllocator.</p>
<p>This class provides an interface for working with allocated objects
including locking and unlocking mechanisms for thread-safe operations.</p>
<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorObject.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allocator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorObject.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorObject.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize a RedisAllocatorObject instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>allocator</strong> (<a class="reference internal" href="#id13" title="redis_allocator.allocator.RedisAllocator"><em>RedisAllocator</em></a>) – The RedisAllocator that created this object</p></li>
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The Redis key for this allocated object</p></li>
<li><p><strong>obj</strong> (<em>U</em><em> | </em><em>None</em>) – The actual object being allocated</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> | </em><em>None</em>) – Additional parameters passed by local program</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorObject.allocator">
<span class="sig-name descname"><span class="pre">allocator</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#id13" title="redis_allocator.allocator.RedisAllocator"><span class="pre">RedisAllocator</span></a></em><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorObject.allocator" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorObject.key">
<span class="sig-name descname"><span class="pre">key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorObject.key" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorObject.obj">
<span class="sig-name descname"><span class="pre">obj</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">U</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorObject.obj" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorObject.params">
<span class="sig-name descname"><span class="pre">params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorObject.params" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorObject.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorObject.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorObject.update" title="Link to this definition"></a></dt>
<dd><p>Lock this object for exclusive access.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>) – How long the lock should be valid (in seconds)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorObject.open">
<span class="sig-name descname"><span class="pre">open</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorObject.open"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorObject.open" title="Link to this definition"></a></dt>
<dd><p>Open the object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorObject.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorObject.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorObject.close" title="Link to this definition"></a></dt>
<dd><p>Kill the object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorObject.is_healthy">
<span class="sig-name descname"><span class="pre">is_healthy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorObject.is_healthy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorObject.is_healthy" title="Link to this definition"></a></dt>
<dd><p>Check if the object is healthy.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorObject.set_healthy">
<span class="sig-name descname"><span class="pre">set_healthy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3600</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorObject.set_healthy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorObject.set_healthy" title="Link to this definition"></a></dt>
<dd><p>Set the object as healthy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>duration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorObject.set_unhealthy">
<span class="sig-name descname"><span class="pre">set_unhealthy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3600</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorObject.set_unhealthy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorObject.set_unhealthy" title="Link to this definition"></a></dt>
<dd><p>Set the object as unhealthy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>duration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorObject.refresh">
<span class="sig-name descname"><span class="pre">refresh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3600</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorObject.refresh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorObject.refresh" title="Link to this definition"></a></dt>
<dd><p>Refresh the object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>cache_timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorObject.refresh_until_healthy">
<span class="sig-name descname"><span class="pre">refresh_until_healthy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_attempts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lock_duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3600</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3600</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorObject.refresh_until_healthy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorObject.refresh_until_healthy" title="Link to this definition"></a></dt>
<dd><p>Refresh the object until it is healthy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>max_attempts</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>lock_duration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>cache_timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorObject.unique_id">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unique_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorObject.unique_id" title="Link to this definition"></a></dt>
<dd><p>Get the unique ID of the object.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorObject.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorObject.name" title="Link to this definition"></a></dt>
<dd><p>Get the name of the object.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorUpdater">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">redis_allocator.allocator.</span></span><span class="sig-name descname"><span class="pre">RedisAllocatorUpdater</span></span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorUpdater"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorUpdater" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class that updates the allocator keys.</p>
<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorUpdater.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorUpdater.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorUpdater.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize the allocator updater.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a><em>]</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorUpdater.fetch">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fetch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorUpdater.fetch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorUpdater.fetch" title="Link to this definition"></a></dt>
<dd><p>Fetch the keys from params.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>param</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><em>Sequence</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorUpdater.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorUpdater.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorUpdater.__call__" title="Link to this definition"></a></dt>
<dd><p>Update the allocator key.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorUpdater.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorUpdater.__len__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorUpdater.__len__" title="Link to this definition"></a></dt>
<dd><p>Get the length of the allocator updater.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">redis_allocator.allocator.</span></span><span class="sig-name descname"><span class="pre">RedisAllocatorPolicy</span></span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorPolicy" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generic" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">U</span></code>]</p>
<p>Abstract base class for Redis allocator policies.</p>
<p>This class defines the interface for allocation policies that can be used
with RedisAllocator to control allocation behavior.</p>
<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorPolicy.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allocator</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorPolicy.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorPolicy.initialize" title="Link to this definition"></a></dt>
<dd><p>Initialize the policy with an allocator instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>allocator</strong> (<a class="reference internal" href="#id13" title="redis_allocator.allocator.RedisAllocator"><em>RedisAllocator</em></a><em>[</em><em>U</em><em>]</em>) – The RedisAllocator instance to use with this policy</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorPolicy.malloc">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">malloc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allocator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3600</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorPolicy.malloc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorPolicy.malloc" title="Link to this definition"></a></dt>
<dd><p>Allocate a resource according to the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>allocator</strong> (<a class="reference internal" href="#id13" title="redis_allocator.allocator.RedisAllocator"><em>RedisAllocator</em></a><em>[</em><em>U</em><em>]</em>) – The RedisAllocator instance</p></li>
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>) – How long the allocation should be valid (in seconds)</p></li>
<li><p><strong>obj</strong> (<em>U</em><em> | </em><em>None</em>) – The object to associate with the allocation</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> | </em><em>None</em>) – Additional parameters for the allocation</p></li>
<li><p><strong>cache_timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>) – Timeout for the soft binding cache entry (seconds).
Defaults to 3600.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>RedisAllocatorObject if allocation was successful, None otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject" title="redis_allocator.allocator.RedisAllocatorObject"><em>RedisAllocatorObject</em></a>[<em>U</em>] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorPolicy.refresh_pool">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">refresh_pool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allocator</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorPolicy.refresh_pool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorPolicy.refresh_pool" title="Link to this definition"></a></dt>
<dd><p>Refresh the allocation pool.</p>
<p>This method is called periodically to update the pool with new resources.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>allocator</strong> (<a class="reference internal" href="#id13" title="redis_allocator.allocator.RedisAllocator"><em>RedisAllocator</em></a><em>[</em><em>U</em><em>]</em>) – The RedisAllocator instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorPolicy.refresh_pool_all">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">refresh_pool_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allocator</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorPolicy.refresh_pool_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorPolicy.refresh_pool_all" title="Link to this definition"></a></dt>
<dd><p>Refresh the allocation pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>allocator</strong> (<a class="reference internal" href="#id13" title="redis_allocator.allocator.RedisAllocator"><em>RedisAllocator</em></a><em>[</em><em>U</em><em>]</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorPolicy.check_health_once">
<span class="sig-name descname"><span class="pre">check_health_once</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3600</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorPolicy.check_health_once"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorPolicy.check_health_once" title="Link to this definition"></a></dt>
<dd><p>Check the health of the object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r_obj</strong> (<a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject" title="redis_allocator.allocator.RedisAllocatorObject"><em>RedisAllocatorObject</em></a><em>[</em><em>U</em><em>]</em>)</p></li>
<li><p><strong>duration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.RedisAllocatorPolicy.check_health">
<span class="sig-name descname"><span class="pre">check_health</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allocator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lock_duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3600</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocatorPolicy.check_health"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.RedisAllocatorPolicy.check_health" title="Link to this definition"></a></dt>
<dd><p>Check the health of the allocator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>allocator</strong> (<a class="reference internal" href="#id13" title="redis_allocator.allocator.RedisAllocator"><em>RedisAllocator</em></a><em>[</em><em>U</em><em>]</em>) – The RedisAllocator instance</p></li>
<li><p><strong>lock_duration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>) – The duration of the lock (in seconds)</p></li>
<li><p><strong>max_threads</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The maximum number of threads to use</p></li>
<li><p><strong>obj_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>, </em><em>U</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>params_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the number of healthy and unhealthy items in the allocator</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="redis_allocator.allocator.DefaultRedisAllocatorPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">redis_allocator.allocator.</span></span><span class="sig-name descname"><span class="pre">DefaultRedisAllocatorPolicy</span></span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#DefaultRedisAllocatorPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.DefaultRedisAllocatorPolicy" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorPolicy" title="redis_allocator.allocator.RedisAllocatorPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedisAllocatorPolicy</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">U</span></code>]</p>
<p>Default implementation of RedisAllocatorPolicy.</p>
<p>This policy provides the following features:
1. Garbage collection before allocation: Automatically performs garbage collection</p>
<blockquote>
<div><p>operations before allocating resources to ensure stale resources are reclaimed.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Soft binding prioritization: Prioritizes allocation of previously bound keys
for named objects, creating a consistent mapping between object names and keys.
If a soft binding exists but the bound key is no longer in the pool, the binding is
ignored and a new key is allocated.</p></li>
<li><p>Periodic pool updates: Uses an optional updater to refresh the pool’s keys at
configurable intervals. Only one process/thread (the one that acquires the update lock)
will perform the update.</p></li>
<li><p>Configurable expiry times: Allows setting default expiry durations for pool items,
ensuring automatic cleanup of stale resources even without explicit garbage collection.</p></li>
</ol>
<p>The policy controls when garbage collection happens, when the pool is refreshed with new keys,
and how allocation prioritizes resources.</p>
<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.DefaultRedisAllocatorPolicy.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gc_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expiry_duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">updater</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_close</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#DefaultRedisAllocatorPolicy.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.DefaultRedisAllocatorPolicy.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize the default allocation policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gc_count</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of GC operations to perform before allocation</p></li>
<li><p><strong>update_interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Interval in seconds between pool updates</p></li>
<li><p><strong>expiry_duration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Default timeout for pool items (-1 means no timeout)</p></li>
<li><p><strong>updater</strong> (<a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorUpdater" title="redis_allocator.allocator.RedisAllocatorUpdater"><em>RedisAllocatorUpdater</em></a><em> | </em><em>None</em>) – Optional updater for refreshing the pool’s keys</p></li>
<li><p><strong>auto_close</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, the allocator will automatically close the object when it is not unique</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.DefaultRedisAllocatorPolicy.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allocator</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#DefaultRedisAllocatorPolicy.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.DefaultRedisAllocatorPolicy.initialize" title="Link to this definition"></a></dt>
<dd><p>Initialize the policy with an allocator instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>allocator</strong> (<a class="reference internal" href="#id13" title="redis_allocator.allocator.RedisAllocator"><em>RedisAllocator</em></a><em>[</em><em>U</em><em>]</em>) – The RedisAllocator instance to use with this policy</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.DefaultRedisAllocatorPolicy.refresh_pool_all">
<span class="sig-name descname"><span class="pre">refresh_pool_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allocator</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#DefaultRedisAllocatorPolicy.refresh_pool_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.DefaultRedisAllocatorPolicy.refresh_pool_all" title="Link to this definition"></a></dt>
<dd><p>Refresh the allocation pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>allocator</strong> (<a class="reference internal" href="#id13" title="redis_allocator.allocator.RedisAllocator"><em>RedisAllocator</em></a><em>[</em><em>U</em><em>]</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.DefaultRedisAllocatorPolicy.malloc">
<span class="sig-name descname"><span class="pre">malloc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allocator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3600</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#DefaultRedisAllocatorPolicy.malloc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.DefaultRedisAllocatorPolicy.malloc" title="Link to this definition"></a></dt>
<dd><p>Allocate a resource according to the policy.</p>
<p>This implementation:
1. Performs GC operations before allocation
2. Checks for soft binding based on object name
3. Falls back to regular allocation if no soft binding exists</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>allocator</strong> (<a class="reference internal" href="#id13" title="redis_allocator.allocator.RedisAllocator"><em>RedisAllocator</em></a><em>[</em><em>U</em><em>]</em>) – The RedisAllocator instance</p></li>
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>) – How long the allocation should be valid (in seconds)</p></li>
<li><p><strong>obj</strong> (<em>U</em><em> | </em><em>None</em>) – The object to associate with the allocation</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> | </em><em>None</em>) – Additional parameters for the allocation</p></li>
<li><p><strong>cache_timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>) – Timeout for the soft binding cache entry (seconds).
Defaults to 3600.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>RedisAllocatorObject if allocation was successful, None otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject" title="redis_allocator.allocator.RedisAllocatorObject"><em>RedisAllocatorObject</em></a>[<em>U</em>] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.DefaultRedisAllocatorPolicy.refresh_pool">
<span class="sig-name descname"><span class="pre">refresh_pool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allocator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#DefaultRedisAllocatorPolicy.refresh_pool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.DefaultRedisAllocatorPolicy.refresh_pool" title="Link to this definition"></a></dt>
<dd><p>Refresh the allocation pool using the updater.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>allocator</strong> (<a class="reference internal" href="#id13" title="redis_allocator.allocator.RedisAllocator"><em>RedisAllocator</em></a><em>[</em><em>U</em><em>]</em>) – The RedisAllocator instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="redis_allocator.allocator.DefaultRedisAllocatorPolicy.finalize">
<span class="sig-name descname"><span class="pre">finalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allocator</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#DefaultRedisAllocatorPolicy.finalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#redis_allocator.allocator.DefaultRedisAllocatorPolicy.finalize" title="Link to this definition"></a></dt>
<dd><p>Finalize the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>allocator</strong> (<a class="reference internal" href="#id13" title="redis_allocator.allocator.RedisAllocator"><em>RedisAllocator</em></a><em>[</em><em>U</em><em>]</em>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="id13">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">redis_allocator.allocator.</span></span><span class="sig-name descname"><span class="pre">RedisAllocator</span></span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id13" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="lock.html#redis_allocator.lock.RedisLockPool" title="redis_allocator.lock.RedisLockPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedisLockPool</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generic" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">U</span></code>]</p>
<p>A Redis-based distributed allocation system.</p>
<p>Manages a pool of resource identifiers (keys) using Redis, allowing distributed
clients to allocate, free, and manage these resources. It leverages Redis’s
atomic operations via Lua scripts for safe concurrent access.</p>
<p>The allocator maintains a doubly-linked list in a Redis hash to track available
(free) resources. Allocated resources are tracked using standard Redis keys
that act as locks.</p>
<p>Key Concepts:
- Allocation Pool: A set of resource identifiers (keys) managed by the allocator.</p>
<blockquote>
<div><p>Stored in a Redis hash (<cite>&lt;prefix&gt;|&lt;suffix&gt;|pool</cite>) representing a doubly-linked list.
Head/Tail pointers are stored in separate keys (<cite>&lt;prefix&gt;|&lt;suffix&gt;|pool|head</cite>,
<cite>&lt;prefix&gt;|&lt;suffix&gt;|pool|tail</cite>).</p>
</div></blockquote>
<ul class="simple">
<li><p>Free List: The subset of keys within the pool that are currently available.
Represented by the linked list structure within the pool hash.</p></li>
<li><p>Allocated State: A key is considered allocated if a corresponding lock key exists
(<cite>&lt;prefix&gt;|&lt;suffix&gt;:&lt;key&gt;</cite>).</p></li>
<li><p>Shared Mode: If <cite>shared=True</cite>, allocating a key moves it to the tail of the
free list but does <em>not</em> create a lock key. This allows multiple clients to
“allocate” the same key concurrently, effectively using the list as a rotating pool.
If <cite>shared=False</cite> (default), allocation creates a lock key, granting exclusive access.</p></li>
<li><p>Soft Binding: Allows associating a logical name with an allocated key. If an object
provides a <cite>name</cite>, the allocator tries to reuse the previously bound key for that name.
Stored in Redis keys like <cite>&lt;prefix&gt;|&lt;suffix&gt;-cache:bind:&lt;name&gt;</cite>.</p></li>
<li><p>Garbage Collection (GC): Periodically scans the pool to reconcile the free list
with the lock states. Removes expired/locked items from the free list and returns
items whose locks have expired back to the free list.</p></li>
<li><p>Policies: Uses <cite>RedisAllocatorPolicy</cite> (e.g., <cite>DefaultRedisAllocatorPolicy</cite>)
to customize allocation behavior, GC triggering, and pool updates.</p></li>
</ul>
<p>Generic type U should implement <cite>RedisAllocatableClass</cite>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">redis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'allocator'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id14" title="Link to this definition"></a></dt>
<dd><p>Initializes the RedisAllocator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>redis</strong> (<a class="reference external" href="https://redis-py.readthedocs.io/en/stable/connections.html#redis.Redis" title="(in redis-py v99.99.99)"><em>Redis</em></a>) – StrictRedis client instance (must decode responses).</p></li>
<li><p><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Prefix for all Redis keys used by this allocator instance.</p></li>
<li><p><strong>suffix</strong> – Suffix to uniquely identify this allocator instance’s keys.</p></li>
<li><p><strong>eps</strong> – Small float tolerance for comparisons (used by underlying lock).</p></li>
<li><p><strong>shared</strong> – If True, operates in shared mode (keys are rotated, not locked).
If False (default), keys are locked upon allocation.</p></li>
<li><p><strong>policy</strong> (<a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorPolicy" title="redis_allocator.allocator.RedisAllocatorPolicy"><em>RedisAllocatorPolicy</em></a><em>[</em><em>U</em><em>] </em><em>| </em><em>None</em>) – Optional allocation policy. Defaults to <cite>DefaultRedisAllocatorPolicy</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">object_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.object_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id15" title="Link to this definition"></a></dt>
<dd><p>Get the key for an object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>obj</strong> (<em>U</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id16">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.clear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id16" title="Link to this definition"></a></dt>
<dd><p>Empty the pool.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id17">
<span class="sig-name descname"><span class="pre">extend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.extend"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id17" title="Link to this definition"></a></dt>
<dd><p>Add new resources to the allocation pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>] </em><em>| </em><em>None</em>) – Sequence of resource identifiers to add to the pool</p></li>
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Optional timeout in seconds for the pool items (-1 means no timeout)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id18">
<span class="sig-name descname"><span class="pre">shrink</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.shrink"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id18" title="Link to this definition"></a></dt>
<dd><p>Remove resources from the allocation pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>] </em><em>| </em><em>None</em>) – Sequence of resource identifiers to remove from the pool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id19">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id19" title="Link to this definition"></a></dt>
<dd><p>Completely replace the resources in the allocation pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.13)"><em>Sequence</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>] </em><em>| </em><em>None</em>) – Sequence of resource identifiers to assign to the pool,
replacing any existing resources</p></li>
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Optional timeout in seconds for the pool items (-1 means no timeout)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id20">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id20" title="Link to this definition"></a></dt>
<dd><p>Get all resource identifiers in the allocation pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Iterable of resource identifiers in the pool</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.13)"><em>Iterable</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id21">
<span class="sig-name descname"><span class="pre">__contains__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.__contains__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id21" title="Link to this definition"></a></dt>
<dd><p>Check if a resource identifier is in the allocation pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> – Resource identifier to check</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the resource is in the pool, False otherwise</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id22">
<span class="sig-name descname"><span class="pre">update_soft_bind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3600</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.update_soft_bind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id22" title="Link to this definition"></a></dt>
<dd><p>Update a soft binding between a name and a resource.</p>
<p>Soft bindings create a persistent mapping between named objects and allocated keys,
allowing the same key to be consistently allocated to the same named object.
This is useful for maintaining affinity between objects and their resources.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name to bind</p></li>
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Resource identifier to bind to the name</p></li>
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id23">
<span class="sig-name descname"><span class="pre">unbind_soft_bind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.unbind_soft_bind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id23" title="Link to this definition"></a></dt>
<dd><p>Remove a soft binding.</p>
<p>This removes the persistent mapping between a named object and its allocated key,
allowing the key to be freely allocated to any requestor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the soft binding to remove</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id24">
<span class="sig-name descname"><span class="pre">get_soft_bind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.get_soft_bind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id24" title="Link to this definition"></a></dt>
<dd><p>Get the resource identifier bound to a name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the soft binding</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id25">
<span class="sig-name descname"><span class="pre">malloc_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3600</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.malloc_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id25" title="Link to this definition"></a></dt>
<dd><p>Allocate a resource key from the pool.</p>
<p>The behavior depends on the allocator’s shared mode:
- In non-shared mode (default): Locks the allocated key for exclusive access
- In shared mode: Simply removes the key from the free list without locking it</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>) – How long the allocation lock should be valid (in seconds).</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – Optional name to use for soft binding.</p></li>
<li><p><strong>cache_timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>) – Timeout for the soft binding cache entry (seconds).
Defaults to 3600. If &lt;= 0, cache entry persists indefinitely.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Resource identifier if allocation was successful, None otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id26">
<span class="sig-name descname"><span class="pre">malloc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3600</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.malloc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id26" title="Link to this definition"></a></dt>
<dd><p>Allocate a resource from the pool and wrap it in a RedisAllocatorObject.</p>
<p>If a policy is configured, it will be used to control the allocation behavior.
Otherwise, the basic allocation mechanism will be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>) – How long the allocation lock should be valid (in seconds)</p></li>
<li><p><strong>obj</strong> (<em>U</em><em> | </em><em>None</em>) – The object to wrap in the RedisAllocatorObject. If it has a <cite>.name</cite>,
soft binding will be attempted.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> | </em><em>None</em>) – Additional parameters to associate with the allocated object.</p></li>
<li><p><strong>cache_timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.13)"><em>timedelta</em></a><em> | </em><em>None</em>) – Timeout for the soft binding cache entry (seconds).
Defaults to 3600. Passed to the policy or <cite>malloc_key</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>RedisAllocatorObject wrapping the allocated resource if successful, None otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject" title="redis_allocator.allocator.RedisAllocatorObject"><em>RedisAllocatorObject</em></a>[<em>U</em>] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id27">
<span class="sig-name descname"><span class="pre">free_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.free_keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id27" title="Link to this definition"></a></dt>
<dd><p>Free allocated resources.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Resource identifiers to free</p></li>
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Optional timeout in seconds for the pool items (-1 means no timeout)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id28">
<span class="sig-name descname"><span class="pre">free</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.free"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id28" title="Link to this definition"></a></dt>
<dd><p>Free an allocated object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> (<a class="reference internal" href="#redis_allocator.allocator.RedisAllocatorObject" title="redis_allocator.allocator.RedisAllocatorObject"><em>RedisAllocatorObject</em></a><em>[</em><em>U</em><em>]</em>) – The allocated object to free</p></li>
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Optional timeout in seconds for the pool item (-1 means no timeout)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id29">
<span class="sig-name descname"><span class="pre">get_free_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.get_free_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id29" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id30">
<span class="sig-name descname"><span class="pre">redis</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://redis-py.readthedocs.io/en/stable/connections.html#redis.Redis" title="(in redis-py v99.99.99)"><span class="pre">Redis</span></a></em><a class="headerlink" href="#id30" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id31">
<span class="sig-name descname"><span class="pre">prefix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#id31" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id32">
<span class="sig-name descname"><span class="pre">suffix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#id32" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id33">
<span class="sig-name descname"><span class="pre">eps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><a class="headerlink" href="#id33" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id34">
<span class="sig-name descname"><span class="pre">gc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/redis_allocator/allocator.html#RedisAllocator.gc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id34" title="Link to this definition"></a></dt>
<dd><p>Perform garbage collection on the allocation pool.</p>
<p>This method scans through the pool and ensures consistency between
the allocation metadata and the actual locks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>count</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of items to check in this garbage collection pass</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="core-concepts-visualization">
<h2>Core Concepts &amp; Visualization<a class="headerlink" href="#core-concepts-visualization" title="Link to this heading"></a></h2>
<section id="allocator-pool-structure-conceptual">
<h3>Allocator Pool Structure (Conceptual)<a class="headerlink" href="#allocator-pool-structure-conceptual" title="Link to this heading"></a></h3>
<p>The allocator manages a pool of resources using several Redis keys:</p>
<ul class="simple">
<li><p><strong>Pool Hash (`&lt;prefix&gt;|&lt;suffix&gt;|pool`)</strong>: Stores the resource keys currently in the pool. The value for each key represents its position in a doubly-linked list used for the free list (e.g., <cite>prev_key||next_key||expiry_timestamp</cite>). A special value (<cite>#ALLOCATED</cite>) indicates the key is part of the pool but not currently free.</p></li>
<li><p><strong>Head Pointer (`…|pool|head`)</strong>: A simple key holding the resource key currently at the head of the free list.</p></li>
<li><p><strong>Tail Pointer (`…|pool|tail`)</strong>: A simple key holding the resource key currently at the tail of the free list.</p></li>
<li><p><strong>Lock Keys (`&lt;prefix&gt;|&lt;suffix&gt;:&lt;key&gt;`)</strong>: Standard Redis keys used as locks in non-shared mode. Their existence indicates a resource is allocated.</p></li>
<li><p><strong>Soft Bind Cache Keys (`&lt;prefix&gt;|&lt;suffix&gt;-cache:bind:&lt;name&gt;`)</strong>: Store the mapping between a logical name and an allocated resource key for soft binding.</p></li>
</ul>
<pre  class="mermaid">
        graph TD
    subgraph Redis Keys
        HKey[&quot;&lt;prefix&gt;|&lt;suffix&gt;|pool|head&quot;] --&gt; Key1[&quot;Key1: &quot;&quot;||Key2||Expiry&quot;]
        TKey[&quot;&lt;prefix&gt;|&lt;suffix&gt;|pool|tail&quot;] --&gt; KeyN[&quot;KeyN: KeyN-1||&quot;&quot;||Expiry&quot;]
        PoolHash[&quot;&lt;prefix&gt;|&lt;suffix&gt;|pool (Hash)&quot;]
    end

    subgraph &quot;PoolHash Contents (Doubly-Linked Free List)&quot;
        Key1 --&gt; Key2[&quot;Key2: Key1||Key3||Expiry&quot;]
        Key2 --&gt; Key3[&quot;Key3: Key2||...||Expiry&quot;]
        Key3 --&gt; ...
        KeyN_1[...] --&gt; KeyN
    end

    subgraph &quot;Allocated Keys (Non-Shared Mode)&quot;
        LKey1[&quot;&lt;prefix&gt;|&lt;suffix&gt;:AllocatedKey1&quot;]
        LKeyX[&quot;&lt;prefix&gt;|&lt;suffix&gt;:AllocatedKeyX&quot;]
    end

    subgraph &quot;Soft Bind Cache&quot;
        CacheKey1[&quot;&lt;prefix&gt;|&lt;suffix&gt;-cache:bind:name1&quot;] --&gt; LKey1
    end
    </pre></section>
<section id="simplified-allocation-flow-non-shared-mode">
<h3>Simplified Allocation Flow (Non-Shared Mode)<a class="headerlink" href="#simplified-allocation-flow-non-shared-mode" title="Link to this heading"></a></h3>
<p>When <cite>malloc</cite> or <cite>malloc_key</cite> is called in non-shared mode:</p>
<ol class="arabic simple">
<li><p>It checks if a name was provided for soft binding.</p></li>
<li><p>If yes, it looks up the name in the soft bind cache.</p></li>
<li><p>If a cached key is found and the corresponding lock key does <em>not</em> exist, the cached key is reused.</p></li>
<li><p>Otherwise (no name, no valid cached key), it attempts to pop a key from the head of the free list (using the Pool Hash and Head Pointer).</p></li>
<li><p>If a key is popped, a lock key is created for it with the specified timeout.</p></li>
<li><p>If a name was provided, the soft bind cache is updated.</p></li>
<li><p>The allocated key (or None) is returned.</p></li>
</ol>
<pre  class="mermaid">
        flowchart TD
    Start --&gt; CheckSoftBind{Soft Bind Name Provided?}
    CheckSoftBind -- Yes --&gt; GetBind{GET bind cache key}
    GetBind --&gt; IsBoundKeyValid{&quot;Cached Key Found and Unlocked?&quot;}
    IsBoundKeyValid -- Yes --&gt; ReturnCached[Return Cached Key]
    IsBoundKeyValid -- No --&gt; PopHead{Pop Head from Free List (Lua pop_from_head)}
    CheckSoftBind -- No --&gt; PopHead
    PopHead --&gt; IsKeyFound{Key Found?}
    IsKeyFound -- Yes --&gt; LockKey[SET Lock Key w/ Timeout]
    LockKey --&gt; UpdateCache{&quot;Update Bind Cache (if name provided)&quot;}
    UpdateCache --&gt; ReturnNewKey[Return New Key]
    IsKeyFound -- No --&gt; ReturnNone[Return None]
    ReturnCached --&gt; End
    ReturnNewKey --&gt; End
    ReturnNone --&gt; End
    </pre></section>
<section id="simplified-free-flow-non-shared-mode">
<h3>Simplified Free Flow (Non-Shared Mode)<a class="headerlink" href="#simplified-free-flow-non-shared-mode" title="Link to this heading"></a></h3>
<p>When <cite>free</cite> or <cite>free_keys</cite> is called in non-shared mode:</p>
<ol class="arabic simple">
<li><p>It attempts to delete the lock key (<cite>&lt;prefix&gt;|&lt;suffix&gt;:&lt;key&gt;</cite>).</p></li>
<li><p>If the lock key existed and was deleted (DEL returns 1), the resource key is added back to the tail of the free list within the Pool Hash.</p></li>
</ol>
<pre  class="mermaid">
        flowchart TD
    Start --&gt; DeleteLock{DEL Lock Key}
    DeleteLock --&gt; Deleted{&quot;Key Existed? (DEL &gt; 0)&quot;}
    Deleted -- Yes --&gt; PushTail[Push Key to Free List Tail (Lua push_to_tail)]
    PushTail --&gt; End
    Deleted -- No --&gt; End
    </pre></section>
</section>
<section id="shared-mode">
<h2>Shared Mode<a class="headerlink" href="#shared-mode" title="Link to this heading"></a></h2>
<p>In shared mode (<cite>shared=True</cite>), the flow is simpler:</p>
<ul class="simple">
<li><p><strong>Allocation</strong>: Pops a key from the head, but immediately pushes it back to the tail without creating a lock key. Soft binding still applies.</p></li>
<li><p><strong>Free</strong>: Effectively a no-op, as no lock key was created during allocation.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="lock.html" class="btn btn-neutral float-left" title="Lock Module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="task_queue.html" class="btn btn-neutral float-right" title="Task Queue Module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024-2025, Invoker Bot.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>